/* mjulb v 0.0.3 | tony[at]formalibre.si | GPL3 Licensed */ var $,__slice=[].slice;$=jQuery; $.fn.extend({mjulb:function(){var f,q,e,r,s,g,t,m,n,u,h,p,i,j,k,l;e=1<=arguments.length?__slice.call(arguments,0):[];h=e.scaling;i=e.transition;q=$("body");e=$(document);j=$(window);s=e.width();r=e.height();l=j.width();k=j.height();f=this.map(function(){return $(this).attr("href")});n=null!=h?h:h=0.9;p=null!=i?i:i=300;g=function(a){var b,c;a.content||(a.content="");a.el||(a.el="div");var d;d=[];for(b in a)c=a[b],"el"!==b&&"content"!==b?d.push(""+b+"='"+c+"'"):d.push(void 0);return"img"!==a.el?"<"+ a.el+" "+d.join(" ")+">"+a.content+"</"+a.el+">":"<"+a.el+" "+d.join(" ")+"/>"};t=g({el:"div",id:"modal",content:[g({el:"div",id:"blind",style:"width:"+s+"px; height:"+r+"px"}),[g({el:"div","class":"content",content:[g({el:"a",id:"rw"}),g({el:"a",id:"fw"})].join("")}),g({el:"img"})].join("")].join("")});u=function(a){var b,c,d;d=l/k;a=a.width/a.height;c=l*n;b=k*n;1<d?c=b*a:b=c/a;return{top:(k-b)/2+j.scrollTop(),left:(l-c)/2,width:c,height:b}};this.on("click",function(a){a.preventDefault();q.append(t); $("#modal").fadeIn();return m($(this).attr("href"))});e.on("click","#modal #fw, #modal #rw",function(a){a.preventDefault();return m($(this).attr("href"))});e.on("click","#modal",function(a){if("fw"!==a.target.id&&"rw"!==a.target.id)return $(this).fadeOut("slow",function(){return $(this).remove()})});m=function(a){var b,c,d,e,h,i,j,k;e=null!=(j=f[b=$.inArray(a,f)-1])?j:f[b]=f[f.length-1];b=null!=(k=f[i=$.inArray(a,f)+1])?k:f[i]=f[0];$("#modal #fw").attr({href:b});$("#modal #rw").attr({href:e});c=$("#modal .content"); d=$("#modal .temp");h=g({el:"div","class":"temp"});return $("<img/>").attr({src:a}).load(function(){var b;b=u(this);b={position:"absolute",display:"none",left:b.left,top:b.top,width:b.width,height:b.height,"background-image":"url('"+a+"')","background-size":"100%","z-index":1};c.attr("style")&&($(h).insertBefore(c),d.attr({style:c.attr("style")}));c.css(b).fadeIn(p,function(){return d.fadeOut(p,function(){return $(this).remove()})});return $("#modal img").css({display:"none"}).attr({src:a})})};return!0}});
