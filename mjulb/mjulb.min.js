(function(a){a.fn.tlb=function(c){function f(b){var f=e[a.inArray(b,e)+1],g=e[a.inArray(b,e)-1];a("#modal #fw").attr({href:f});a("#modal #rw").attr({href:g});a("<img/>").attr({src:b}).load(function(){var d;d=c.scaling;dw=a(window).width();dh=a(window).height();wasp=dw/dh;iasp=this.width/this.height;d=wasp>iasp?{top:dh/2-dh*d/2+a(window).scrollTop(),left:dw/2-dh*d*iasp/2,width:dh*d*iasp,height:dh*d,apect:iasp}:{top:dh/2-dw*d*iasp/2+a(window).scrollTop(),left:dw/2-dh*d/2,width:dh*d,height:dw*d*iasp, apect:iasp};d={position:"absolute",display:"none",left:d.left,top:d.top,width:d.width,height:d.height,"background-image":"url("+b+")","background-size":"100%","z-index":1};a("#modal .image").attr("style")&&(a('<div class="temp"></div>').insertBefore("#modal .image"),a("#modal .temp").attr({style:a("#modal .image").attr("style")}));a("#modal .image").css(d).fadeIn(c.transition,function(){a("#modal .temp").fadeOut(c.transition,function(){a(this).remove()})});a("#modal img").css({display:"none"}).attr({src:b})})} c="undefined"==typeof c?{}:c;c.scaling="undefined"==typeof c.scaling?0.9:c.scaling;c.transition="undefined"==typeof c.transition?300:c.transition;c.imageband="undefined"==typeof c.imageband?!1:c.imageband;var e=[];a(this).map(function(){e.push(a(this).attr("href"))});this.on("click",function(b){b.preventDefault();b=a(this).attr("href");a("body").append('<div id="modal"><div id="blind"></div><div class="image"><a id="rw" href="#"><span>&#x25c0</span></a><a id="fw" href="#"><span>&#x25b6;</span></a></div><img/></div>'); a("#modal").css({width:a(document).width(),height:a(document).height()}).fadeIn();f(b)});a(document).on("click","#modal #rw, #modal #fw",function(b){b.preventDefault();b=a(this).attr("href");f(b)});a(document).on("click","#modal",function(b){"fw"!=b.target.id&&"rw"!=b.target.id&&a(this).fadeOut("slow",function(){a(this).remove()})});if(!1!=c.imageband&&0<a(".gallery.container").length){var h='<div class="gallery">'+a.map(this,function(b){return'<div class="thumb frame">'+a(b).parent().html()+"</div>"}).join("")+ "</div>",g;a("body").append('<div id="imageband"></div>');a("#imageband").css({display:"none","z-index":3});a("#imageband").append(h);g=(a("#imageband .gallery .frame .image").outerWidth()+15)*e.length;a("#imageband .gallery").css({position:"absolute",width:g});a(document).mousemove(function(b){b.pageY>a(document).scrollTop()+a(window).height()-200?a("#imageband").fadeIn(c.transition):a("#imageband").fadeOut(c.transition);positioning=-g/a(window).width()*b.pageX+b.pageX;a("#imageband .gallery").css({left:positioning})})}a(document).on("click", "#imageband .gallery .thumb.frame a",function(b){b.preventDefault();b=a(this).attr("href");a("body").append('<div id="modal"><div id="blind"></div><div class="image"><a id="rw" href="#"><span>&#x25c0</span></a><a id="fw" href="#"><span>&#x25b6;</span></a></div><img/></div>');a("#modal").css({width:a(document).width(),height:a(document).height()}).fadeIn();f(b)})}})(jQuery);
